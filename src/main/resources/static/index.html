<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>도토리 플래너</title>

    <meta name="description" content="나만의 스마트한 예산 관리, 도토리 플래너.">
    <meta property="og:type" content="website">
    <meta property="og:title" content="도토리 플래너">
    <meta property="og:description" content="지출, 수입, 예산을 한눈에 관리하세요.">
    <meta property="og:image" content="/images/dotori_main.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Styles -->
    <link rel="stylesheet" href="style.css?v=3">
    <link rel="manifest" href="manifest.json?v=2">
</head>

<body>
    <div class="app-background">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <div class="app-container">
        <!-- Sidebar / Navigation -->
        <nav class="sidebar glass-panel" id="sidebar">
            <a href="/home" class="logo" style="text-decoration: none; color: inherit;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                    style="margin-right: 0.8rem; width: 1.8rem; height: 1.8rem;">
                    <path
                        d="M12 0 L11.2 3.2 H6 C4.3 3.2 3 4.5 3 6.2 V8 H21 V6.2 C21 4.5 19.7 3.2 18 3.2 H12.8 L12 0 Z M5 9 C5 16 9.5 22.5 12 22.5 C14.5 22.5 19 16 19 9 H5 Z" />
                </svg>
                <span data-i18n="app-name">도토리 플래너</span>
            </a>

            <!-- Budget Switcher -->
            <div class="budget-switcher" style="padding: 0 1rem 1rem 1rem;">
                <div style="position: relative;">
                    <button id="budget-selector-btn" class="glass-panel"
                        style="width: 100%; padding: 1rem 1.2rem; display: flex; justify-content: space-between; align-items: center; cursor: pointer; border: none; border-radius: 12px; font-weight: 500; font-size: 0.9rem; color: var(--text-primary);">
                        <span id="current-budget-name">로딩 중...</span>
                        <i class="fa-solid fa-chevron-down" style="font-size: 0.8rem; opacity: 0.7;"></i>
                    </button>
                    <div id="budget-dropdown" class="glass-panel"
                        style="position: absolute; top: 110%; left: 0; width: 100%; z-index: 100; display: none; padding: 0.5rem; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); max-height: 200px; overflow-y: auto;">
                        <ul id="budget-list" style="list-style: none; padding: 0; margin: 0;">
                            <!-- Items injected by JS -->
                        </ul>
                        <div style="height: 1px; background: var(--glass-border); margin: 0.5rem 0;"></div>
                        <button id="btn-add-budget-group"
                            style="width: 100%; padding: 0.6rem; text-align: left; background: none; border: none; cursor: pointer; color: var(--accent-color); font-weight: 600; display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem;">
                            <i class="fa-solid fa-plus-circle"></i> 새 가계부 만들기
                        </button>
                    </div>
                </div>
            </div>

            <ul class="nav-links">
                <li class="active" data-tab="dashboard">
                    <i class="fa-solid fa-chart-pie"></i>
                    <span data-i18n="nav-dashboard">대시보드</span>
                </li>
                <li data-tab="fixed-expenses">
                    <i class="fa-solid fa-file-invoice-dollar"></i>
                    <span data-i18n="nav-fixed-expenses">고정 지출</span>
                </li>
                <li data-tab="calendar">
                    <i class="fa-solid fa-calendar-days"></i>
                    <span data-i18n="nav-calendar">달력</span>
                </li>
                <li data-tab="transactions">
                    <i class="fa-solid fa-list-ul"></i>
                    <span data-i18n="nav-transactions">내역</span>
                </li>
                <li data-tab="notices">
                    <i class="fa-solid fa-bullhorn"></i>
                    <span data-i18n="nav-notices">공지사항</span>
                </li>
                <li data-tab="analysis">
                    <i class="fa-solid fa-chart-line"></i>
                    <span data-i18n="nav-analysis">상세 분석</span>
                </li>
            </ul>



            <div class="user-profile">
                <div class="avatar" id="user-avatar">
                    🐿️
                </div>
                <div class="user-info">
                    <span class="name" id="user-name">로딩 중...</span>
                    <span class="role" id="user-email">-</span>
                </div>
                <button onclick="logout()" class="icon-btn" style="margin-left: auto; color: rgba(255, 255, 255, 0.7);"
                    title="로그아웃">
                    <i class="fa-solid fa-right-from-bracket"></i>
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Mobile Header -->
            <div class="mobile-header">
                <button id="mobile-menu-btn" class="icon-btn" style="color: var(--text-primary); font-size: 1.5rem;">
                    <i class="fa-solid fa-bars"></i>
                </button>
                <div class="mobile-logo">
                    <span>🌰</span> 도토리 플래너
                </div>
                <div style="width: 32px;"></div> <!-- Spacer -->
            </div>

            <header class="top-header">
                <div class="date-selector">
                    <button id="prev-month" class="icon-btn"><i class="fa-solid fa-chevron-left"></i></button>
                    <h2 id="current-month-display">2026년 1월</h2>
                    <button id="next-month" class="icon-btn"><i class="fa-solid fa-chevron-right"></i></button>

                    <div class="today-badge"
                        style="margin-left: 1rem; padding: 0.4rem 0.8rem; background: rgba(85, 139, 47, 0.1); border-radius: 20px; font-size: 0.85rem; color: var(--accent-color); font-weight: 500; display: flex; align-items: center; gap: 0.4rem; white-space: nowrap;">
                        <i class="fa-solid fa-calendar-check"></i>
                        <span id="today-date-text"></span>
                    </div>
                </div>
                <div class="actions">
                    <button class="btn btn-primary" id="open-budget-modal">
                        <i class="fa-solid fa-gear"></i> <span data-i18n="btn-budget-settings">예산 설정</span>
                    </button>
                    <button class="btn btn-primary" id="open-fixed-modal">
                        <i class="fa-solid fa-file-invoice-dollar"></i> <span data-i18n="btn-add-fixed">고정 지출 추가</span>
                    </button>
                    <button class="btn btn-income" id="open-income-modal">
                        <i class="fa-solid fa-money-bill-wave"></i> <span data-i18n="btn-add-income">수입 추가</span>
                    </button>
                    <button class="btn btn-expense" id="open-add-modal">
                        <i class="fa-solid fa-minus"></i> <span data-i18n="btn-add-expense">지출 추가</span>
                    </button>
                </div>
            </header>

            <!-- Dashboard View -->
            <div id="view-dashboard" class="view-section active">
                <div class="summary-cards">
                    <div class="card glass-panel summary-card total">
                        <div class="card-icon"><i class="fa-solid fa-sack-dollar"></i></div>
                        <div class="card-info">
                            <h3 data-i18n="card-total-budget">총 예산</h3>
                            <p id="display-total-budget">₩0</p>
                        </div>
                    </div>
                    <div class="card glass-panel summary-card spent">
                        <div class="card-icon"><i class="fa-solid fa-credit-card"></i></div>
                        <div class="card-info">
                            <h3 data-i18n="card-spent">지출 금액</h3>
                            <p id="display-spent">₩0</p>
                        </div>
                    </div>
                    <div class="card glass-panel summary-card remaining">
                        <div class="card-icon"><i class="fa-solid fa-piggy-bank"></i></div>
                        <div class="card-info">
                            <h3 data-i18n="card-remaining">남은 잔액</h3>
                            <p id="display-remaining">₩0</p>
                        </div>
                    </div>
                    <div class="card glass-panel summary-card daily">
                        <div class="card-icon"><i class="fa-solid fa-calendar-day"></i></div>
                        <div class="card-info">
                            <h3 data-i18n="card-daily-budget">일일 권장 지출</h3>
                            <p id="display-daily-budget">₩0</p>
                            <small id="daily-days-left"
                                style="font-size:0.75rem; color:var(--text-secondary); display:block; margin-top:4px;">(남은
                                일수 계산 중)</small>
                        </div>
                    </div>
                </div>

                <div class="charts-row">
                    <div class="card glass-panel main-chart">
                        <div class="card-header">
                            <h3 data-i18n="chart-expense-trend">지출 흐름</h3>
                        </div>
                        <div class="chart-container">
                            <div class="bar-chart" id="expense-trend-chart">
                                <!-- Bars will be injected here -->
                            </div>
                        </div>
                    </div>

                    <div class="card glass-panel category-chart-card">
                        <div class="card-header">
                            <h3 data-i18n="chart-category">카테고리별 지출</h3>
                        </div>
                        <div
                            style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding-bottom: 1rem;">
                            <div style="position: relative; width: 140px; height: 140px;">
                                <div id="category-donut-chart" style="width: 100%; height: 100%; border-radius: 50%;">
                                </div>
                                <div
                                    style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 60%; height: 60%; background: var(--glass-bg); border-radius: 50%; box-shadow: inset 0 0 10px rgba(0,0,0,0.05);">
                                </div>
                            </div>
                            <div id="category-legend"
                                style="margin-top: 1rem; display: flex; flex-wrap: wrap; justify-content: center; gap: 8px;">
                            </div>
                        </div>
                    </div>

                    <div class="card glass-panel recent-transactions">
                        <div class="card-header">
                            <h3 data-i18n="recent-transactions">최근 내역</h3>
                            <button class="text-btn" id="view-all-tx" data-i18n="btn-view-all">모두 보기</button>
                        </div>
                        <ul class="transaction-list-mini" id="recent-tx-list">
                            <!-- Items injected here -->
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Fixed Expenses View -->
            <div id="view-fixed-expenses" class="view-section">
                <div class="card glass-panel full-list-card">
                    <div class="card-header">
                        <h3 data-i18n="title-fixed-expenses">고정 지출 관리</h3>
                    </div>
                    <div class="table-container">
                        <ul class="transaction-list-mini" id="fixed-expenses-list-ul">
                            <!-- Items injected via JS -->
                        </ul>
                        <div id="fixed-expenses-empty"
                            style="text-align: center; padding: 2rem; color: var(--text-secondary); display: none;">
                            등록된 고정 지출이 없습니다.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calendar View -->
            <div id="view-calendar" class="view-section">
                <div class="card glass-panel calendar-wrapper">
                    <div class="calendar-header">
                        <div data-i18n="day-sun">일</div>
                        <div data-i18n="day-mon">월</div>
                        <div data-i18n="day-tue">화</div>
                        <div data-i18n="day-wed">수</div>
                        <div data-i18n="day-thu">목</div>
                        <div data-i18n="day-fri">금</div>
                        <div data-i18n="day-sat">토</div>
                    </div>
                    <div class="calendar-grid" id="calendar-grid">
                        <!-- Days injected via JS -->
                    </div>
                </div>
            </div>

            <!-- Transactions View -->
            <div id="view-transactions" class="view-section">
                <div class="card glass-panel full-list-card">
                    <div class="list-filters">
                        <input type="text" data-i18n-placeholder="search-placeholder" placeholder="내역 검색..."
                            class="search-input">
                        <select class="category-select" data-i18n-label="filter-all-categories">
                            <option value="all">모든 카테고리</option>
                        </select>
                    </div>
                    <div class="table-container">
                        <ul class="transaction-list-mini" id="full-tx-list-ul">
                            <!-- Items injected via JS -->
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Notices View -->
            <div id="view-notices" class="view-section">
                <div class="card glass-panel full-list-card">
                    <div class="card-header">
                        <h3 data-i18n="nav-notices">공지사항</h3>
                        <button class="btn btn-primary" id="btn-write-notice" style="display:none;"
                            data-i18n="btn-write-notice">글쓰기</button>
                    </div>
                    <div id="notice-list-container" class="notice-list"
                        style="display: flex; flex-direction: column; gap: 1rem;">
                        <!-- Injected JS -->
                    </div>
                </div>
            </div>
            <!-- Analysis View -->
            <div id="view-analysis" class="view-section">
                <div class="card glass-panel" style="margin-bottom: 2rem;">
                    <div class="card-header">
                        <h3>기간 상세 분석</h3>
                    </div>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: flex-end; margin-top: 1rem;">
                        <div class="form-group" style="margin-bottom: 0; flex: 1; min-width: 140px;">
                            <label>시작일</label>
                            <input type="date" id="analysis-start-date">
                        </div>
                        <div class="form-group" style="margin-bottom: 0; flex: 1; min-width: 140px;">
                            <label>종료일</label>
                            <input type="date" id="analysis-end-date">
                        </div>
                        <button id="btn-run-analysis" class="btn btn-primary" style="height: 48px; min-width: 100px;">
                            <i class="fa-solid fa-magnifying-glass"></i> 조회
                        </button>
                    </div>
                </div>

                <div id="analysis-results" style="display: none;">
                    <div class="summary-cards">
                        <div class="card glass-panel summary-card total" style="flex:1;">
                            <div class="card-info">
                                <h3>총 수입</h3>
                                <p id="analysis-total-income" style="color:var(--income-color);">0</p>
                            </div>
                        </div>
                        <div class="card glass-panel summary-card spent" style="flex:1;">
                            <div class="card-info">
                                <h3>총 지출</h3>
                                <p id="analysis-total-expense" style="color:var(--expense-color);">0</p>
                            </div>
                        </div>
                        <div class="card glass-panel summary-card remaining" style="flex:1;">
                            <div class="card-info">
                                <h3>차액</h3>
                                <p id="analysis-balance">0</p>
                            </div>
                        </div>
                    </div>

                    <div class="charts-row" style="margin-top:2rem;">
                        <div class="card glass-panel category-chart-card" style="width:100%; max-width:100%;">
                            <div class="card-header">
                                <h3>카테고리별 지출 (기간)</h3>
                            </div>
                            <div style="height:300px; display:flex; justify-content:center; align-items:center;">
                                <div id="analysis-donut-container"
                                    style="width: 250px; height: 250px; position: relative;">
                                    <div id="analysis-donut-chart" style="width:100%; height:100%; border-radius:50%;">
                                    </div>
                                    <div
                                        style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 60%; height: 60%; background: var(--glass-bg); border-radius: 50%; box-shadow: inset 0 0 10px rgba(0,0,0,0.05);">
                                    </div>
                                </div>
                                <div id="analysis-legend"
                                    style="margin-left: 2rem; display: flex; flex-direction: column; gap: 8px;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="card glass-panel full-list-card" style="margin-top:2rem;">
                        <div class="card-header">
                            <h3>내역 목록</h3>
                        </div>
                        <ul class="transaction-list-mini" id="analysis-tx-list"></ul>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Upgrade Modal -->
    <div class="modal-overlay" id="upgrade-modal">
        <div class="modal upgrade-modal-content">
            <span class="close-modal" id="close-upgrade-modal">&times;</span>
            <div class="upgrade-header">
                <div class="crown-icon">
                    <img src="/images/dotori_king.png?v=2" alt="Premium Squirrel">
                </div>
                <h2>Upgrade to Pro</h2>
                <p>더 자유롭게, 더 스마트하게 자산을 관리하세요.</p>
            </div>
            <div class="upgrade-benefits">
                <div class="benefit-item">
                    <i class="fa-solid fa-layer-group"></i>
                    <div>
                        <h4>가계부 최대 30개 생성</h4>
                        <p>여행, 모임, 경조사 등 목적별로 넉넉하게 관리하세요.</p>
                    </div>
                </div>
                <div class="benefit-item">
                    <i class="fa-solid fa-mug-hot"></i>
                    <div>
                        <h4>월 1,900원</h4>
                        <p>커피 반 잔 값으로 누리는 스마트한 소비 습관!</p>
                    </div>
                </div>
            </div>
            <div class="upgrade-actions">
                <button id="btn-confirm-upgrade" class="btn-upgrade-action">
                    <span>Pro로 업그레이드 하기</span>
                    <i class="fa-solid fa-arrow-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal-overlay" id="add-modal">
        <div class="modal glass-panel">
            <div class="modal-header">
                <h3 id="add-modal-title" data-i18n="modal-add-expense">새 내역 추가</h3>
                <button class="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <form id="add-tx-form">
                <div class="type-selector" style="display: none;">
                    <label style="flex: 1; margin: 0;">
                        <input type="radio" name="tx-type" value="EXPENSE" checked style="display: none;"
                            onchange="updateModalType()">
                        <div class="type-btn active" id="type-btn-expense" <div class="type-btn" id="type-btn-expense"
                            style="padding: 0.6rem; text-align: center; border-radius: 6px; cursor: pointer; transition: all 0.2s; font-weight: 600;"
                            data-i18n="type-expense">
                            지출</div>
                    </label>
                    <label style="flex: 1; margin: 0;">
                        <input type="radio" name="tx-type" value="INCOME" style="display: none;"
                            onchange="updateModalType()">
                        <div class="type-btn" id="type-btn-income"
                            style="padding: 0.6rem; text-align: center; border-radius: 6px; cursor: pointer; transition: all 0.2s; font-weight: 600; color: var(--text-secondary);"
                            data-i18n="type-income">
                            수입</div>
                    </label>
                </div>

                <div class="form-group">
                    <label data-i18n="label-date">날짜</label>
                    <input type="date" id="tx-date" required>
                </div>
                <div class="form-group">
                    <label data-i18n="label-description">내용</label>
                    <input type="text" id="tx-desc" placeholder="예: 점심 식사" required>
                </div>
                <div class="form-group">
                    <label data-i18n="label-amount">금액</label>
                    <input type="text" id="tx-amount" placeholder="0" required inputmode="numeric">
                </div>
                <div class="form-group">
                    <label data-i18n="label-category">카테고리</label>
                    <select id="tx-category">
                        <option value="food" data-i18n="category-food">식비</option>
                        <option value="transport" data-i18n="category-transport">교통</option>
                        <option value="shopping" data-i18n="category-shopping">쇼핑</option>
                        <option value="bills" data-i18n="category-bills">공과금</option>
                        <option value="other" data-i18n="category-other">기타</option>
                    </select>
                </div>
                <!-- Payment Method -->
                <div class="form-group" id="tx-method-group">
                    <label>결제 수단</label>
                    <div class="segmented-control">
                        <input type="radio" name="tx-method" id="tx-method-card" value="CARD" checked>
                        <label for="tx-method-card">카드</label>

                        <input type="radio" name="tx-method" id="tx-method-cash" value="CASH">
                        <label for="tx-method-cash">현금</label>
                    </div>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 1rem; align-items: center;">
                    <button type="button" id="btn-delete-tx" class="btn"
                        style="background:var(--danger-color); color:white; display:none; flex:1; height:48px; display:flex; align-items:center; justify-content:center; margin:0;">삭제</button>
                    <button type="submit" id="btn-save-tx" class="btn btn-accent full-width"
                        style="flex:3; height:48px; display:flex; align-items:center; justify-content:center; margin:0;"
                        data-i18n="btn-add">추가하기</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="fixed-modal">
        <div class="modal glass-panel">
            <div class="modal-header">
                <h3 data-i18n="modal-add-fixed">고정 지출 추가</h3>
                <button class="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </div>

            <!-- Existing Fixed Expenses in Modal -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.8rem;">
                <h4 style="margin: 0; color: var(--text-primary); font-size: 0.95rem;"
                    data-i18n="header-registered-list">등록된 목록</h4>
                <button id="btn-copy-prev-fixed" type="button"
                    style="background:none; border:none; color:var(--accent-color); font-size:0.8rem; cursor:pointer; font-weight:600;">
                    <i class="fa-solid fa-rotate-left"></i> <span data-i18n="btn-copy-prev">지난달 내역 불러오기</span>
                </button>
            </div>
            <div id="modal-fixed-list"
                style="margin-bottom: 1.5rem; max-height: 150px; overflow-y: auto; display: flex; flex-direction: column; gap: 0.5rem; padding-right: 4px;">
                <!-- JS will popuate this -->
                <div class="empty-msg" style="color: var(--text-secondary); font-size: 0.8rem;">로딩 중...</div>
            </div>

            <div class="divider" style="height: 1px; background: var(--glass-border); margin-bottom: 1.5rem;"></div>

            <form id="fixed-tx-form">
                <div class="form-group">
                    <label data-i18n="label-category">카테고리</label>
                    <select id="new-fixed-category">
                        <!-- JS populated -->
                    </select>
                </div>
                <div class="form-group">
                    <label data-i18n="table-fixed-name">항목명</label>
                    <input type="text" id="new-fixed-name" placeholder="예: 월세, 넷플릭스" required>
                </div>
                <div class="form-group">
                    <label data-i18n="label-amount">금액</label>
                    <input type="text" id="new-fixed-amount" placeholder="0" required inputmode="numeric">
                </div>
                <!-- Fixed Payment Method -->
                <div class="form-group">
                    <label>결제 수단</label>
                    <div class="segmented-control">
                        <input type="radio" name="fixed-method" id="fixed-method-card" value="CARD" checked>
                        <label for="fixed-method-card">카드</label>

                        <input type="radio" name="fixed-method" id="fixed-method-cash" value="CASH">
                        <label for="fixed-method-cash">현금</label>
                    </div>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 1rem; align-items: center;">
                    <button type="button" id="btn-delete-fixed" class="btn"
                        style="background:var(--danger-color); color:white; display:none; flex:1; height:48px; display:flex; align-items:center; justify-content:center; margin:0;"
                        data-i18n="btn-delete">삭제</button>
                    <button type="submit" class="btn btn-primary full-width"
                        style="flex:3; height:48px; display:flex; align-items:center; justify-content:center; margin:0;"
                        data-i18n="btn-add">추가하기</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="notice-modal">
        <div class="modal glass-panel">
            <div class="modal-header">
                <h3 data-i18n="modal-write-notice">공지사항 작성</h3>
                <button class="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <form id="notice-form">
                <div class="form-group">
                    <label data-i18n="label-title">제목</label>
                    <input type="text" id="notice-title" required>
                </div>
                <div class="form-group">
                    <label data-i18n="label-content">내용</label>
                    <textarea id="notice-content" rows="6" required
                        style="width:100%; padding:0.8rem; border-radius:8px; border:1px solid var(--glass-border); background:rgba(255,255,255,0.5);"></textarea>
                </div>
                <button type="submit" class="btn btn-primary full-width" data-i18n="btn-save">저장</button>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="budget-modal">
        <div class="modal glass-panel">
            <div class="modal-header">
                <h3 id="budget-modal-title" data-i18n="title-budget-settings">예산 설정</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="budget-form">
                <div class="form-group">
                    <label data-i18n="label-total-budget">월 총 예산 (수입)</label>
                    <input type="text" id="budget-input" placeholder="예: 2,000,000" inputmode="numeric" required>
                </div>

                <div class="form-group" style="margin-top: 1.5rem;">
                    <label>가계부 시작일 설정</label>
                    <div style="display:flex; align-items:center; gap:0.5rem;">
                        <span style="font-size:0.9rem;">매월</span>
                        <input type="number" id="budget-start-day-input" min="1" max="31" value="1"
                            style="width:60px; padding:0.6rem; border-radius:8px; border:1px solid var(--glass-border); text-align:center;">
                        <span style="font-size:0.9rem;">일에 시작</span>
                    </div>
                    <p style="font-size:0.8rem; color:var(--text-secondary); margin-top:0.4rem;">
                        (예: 25일로 설정 시, 이번 달 25일 ~ 다음 달 24일까지를 한 달로 관리합니다)
                    </p>
                </div>

                <div class="summary-preview"
                    style="background: rgba(85, 139, 47, 0.1); padding: 1rem; border-radius: 12px; margin-top: 1.5rem;">
                    <div
                        style="display: flex; justify-content: space-between; font-weight: 700; color: var(--accent-color);">
                        <span data-i18n="label-current-budget">현재 설정된 예산</span>
                        <span id="preview-total-budget">0</span>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary full-width">예산 저장하기</button>
            </form>
        </div>
    </div>

    <!-- Daily Details Modal -->
    <div class="modal-overlay" id="daily-modal">
        <div class="modal glass-panel" style="max-width: 500px">
            <div class="modal-header">
                <h3 id="daily-date-title">날짜 상세</h3>
                <button class="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div id="daily-tx-list-container" class="daily-list-container">
                <!-- List injected here -->
            </div>
            <div class="daily-total-summary" id="daily-total-amount"
                style="width: 100%; display: flex; flex-direction: column; gap: 4px; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(0,0,0,0.05);">
                <!-- JS populated -->
            </div>
        </div>
    </div>

    <!-- Create Budget Group Modal -->
    <div class="modal-overlay" id="budget-group-modal">
        <div class="modal glass-panel">
            <div class="modal-header">
                <h3>새 가계부 만들기</h3>
                <button class="close-modal"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <form id="budget-group-form">
                <div class="form-group">
                    <label>가계부 이름</label>
                    <input type="text" id="new-budget-group-name" placeholder="예: 여행용, 데이트용" required>
                </div>
                <div
                    style="background: rgba(85, 139, 47, 0.1); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; font-size: 0.9rem;">
                    <i class="fa-solid fa-circle-info" style="color: var(--accent-color); margin-right: 0.5rem;"></i>
                    새로운 가계부를 만들면 기존 가계부와는 완전히 분리된 별도의 공간이 생성됩니다.
                </div>
                <button type="submit" class="btn btn-primary full-width">만들기</button>
            </form>
        </div>
    </div>

    <script src="i18n.js?v=4"></script>
    <script src="app.js?v=4"></script>
</body>

</html>